# 腾讯翻译君词典API集成说明文档

## 一、项目规划

### 1.1 项目背景

本项目旨在将现有系统中的百度翻译API调用替换为腾讯翻译君词典API调用，以提供更稳定和高质量的翻译服务。同时保持现有的功能接口和用户体验，确保系统的平稳过渡和向后兼容性。

### 1.2 目标与范围

- **主要目标**：集成腾讯翻译君词典API作为主要翻译服务
- **次要目标**：保留百度翻译和火山AI作为备用方案，确保系统稳定性
- **工作范围**：
  - 实现腾讯翻译API调用函数
  - 实现腾讯词典API调用函数
  - 修改现有入口函数，支持新API
  - 创建测试脚本
  - 更新文档和部署指南

### 1.3 时间规划

- **启动时间**：2023-11-15
- **完成时间**：2023-11-15
- **关键时间节点**：
  - API调用函数实现：2023-11-15 10:00
  - 入口函数修改：2023-11-15 14:00
  - 测试与文档更新：2023-11-15 16:00
  - 最终验收：2023-11-15 18:00

## 二、实施方案

### 2.1 技术方案

1. **API集成方式**：
   - 直接调用腾讯翻译API REST接口
   - 实现正确的签名机制和参数处理
   - 保留现有的缓存机制

2. **兼容性设计**：
   - 添加`useTencent`参数，与现有`useBaidu`参数并存
   - 优先使用腾讯API，保持向后兼容
   - 实现多级备用机制，确保服务稳定

3. **错误处理策略**：
   - 详细记录API调用错误
   - 自动尝试备用API
   - 提供清晰的错误提示

### 2.2 实施步骤

1. **环境变量配置研究**
2. **实现腾讯翻译API调用函数**
3. **实现腾讯词典API调用函数**
4. **修改translate.ts入口函数**
5. **修改word-query.ts入口函数**
6. **创建测试脚本**
7. **更新文档和部署指南**

### 2.3 资源需求

- **腾讯API密钥**：需要申请腾讯云翻译服务的应用ID和密钥
- **开发工具**：Node.js开发环境
- **测试环境**：本地开发服务器

## 三、进度记录

### 3.1 任务完成情况

| 任务名称 | 计划时间 | 实际完成时间 | 状态 | 备注 |
|---------|---------|------------|------|------|
| 环境变量配置研究 | 2023-11-15 09:00 | 2023-11-15 09:30 | ✅ 完成 | 已明确腾讯API所需环境变量 |
| 实现腾讯翻译API调用函数 | 2023-11-15 10:00 | 2023-11-15 11:00 | ✅ 完成 | 已在translate.ts中实现 |
| 实现腾讯词典API调用函数 | 2023-11-15 11:00 | 2023-11-15 12:00 | ✅ 完成 | 已在word-query.ts中实现 |
| 修改translate.ts入口函数 | 2023-11-15 13:00 | 2023-11-15 13:30 | ✅ 完成 | 已添加useTencent参数支持 |
| 修改word-query.ts入口函数 | 2023-11-15 13:30 | 2023-11-15 14:00 | ✅ 完成 | 已添加useTencent参数支持 |
| 创建测试脚本 | 2023-11-15 14:30 | 2023-11-15 15:00 | ✅ 完成 | 已创建test-tencent-api.js |
| 更新文档和部署指南 | 2023-11-15 15:00 | 2023-11-15 16:00 | ✅ 完成 | 已更新部署指南和添加6A文档 |
| 创建验收文档 | 2023-11-15 16:00 | 2023-11-15 16:30 | ✅ 完成 | 已创建ACCEPTANCE文档 |
| 创建最终报告 | 2023-11-15 16:30 | 2023-11-15 17:30 | ✅ 完成 | 已创建FINAL文档 |
| 创建TODO清单 | 2023-11-15 17:30 | 2023-11-15 18:00 | ✅ 完成 | 已创建TODO文档 |

### 3.2 遇到的问题及解决方案

1. **API签名机制复杂性**：
   - 问题：腾讯API的签名生成过程较为复杂，包含随机字符串、时间戳等多个参数
   - 解决方案：仔细参考API文档，分步实现签名生成逻辑，确保正确性

2. **兼容性处理**：
   - 问题：需要同时支持新旧API，确保向后兼容性
   - 解决方案：添加新的参数选项，同时保留原有参数支持，实现智能判断逻辑

### 3.3 下一阶段计划

目前所有计划任务均已完成，后续建议：

1. **监控系统集成**：建议添加API调用监控，跟踪成功率和响应时间
2. **定期维护**：每90天更换一次API密钥，提高安全性
3. **性能优化**：根据实际使用情况，优化缓存策略和API调用频率

## 四、文档管理

### 4.1 相关文档清单

- **对齐文档**：`ALIGNMENT_tencent_translation_api.md`
- **共识文档**：`CONSENSUS_tencent_translation_api.md`
- **设计文档**：`DESIGN_tencent_translation_api.md`
- **任务拆分文档**：`TASK_tencent_translation_api.md`
- **验收文档**：`ACCEPTANCE_tencent_translation_api.md`
- **最终报告**：`FINAL_tencent_translation_api.md`
- **待办清单**：`TODO_tencent_translation_api.md`

### 4.2 文档更新记录

| 文档名称 | 最后更新时间 | 更新内容 | 更新人 |
|---------|------------|---------|-------|
| 说明文档.md | 2023-11-15 | 初始创建 | AI助手 |
| ALIGNMENT_tencent_translation_api.md | 2023-11-15 | 初始创建 | AI助手 |
| CONSENSUS_tencent_translation_api.md | 2023-11-15 | 初始创建 | AI助手 |
| DESIGN_tencent_translation_api.md | 2023-11-15 | 初始创建 | AI助手 |
| TASK_tencent_translation_api.md | 2023-11-15 | 初始创建 | AI助手 |
| ACCEPTANCE_tencent_translation_api.md | 2023-11-15 | 初始创建 | AI助手 |
| FINAL_tencent_translation_api.md | 2023-11-15 | 初始创建 | AI助手 |
| TODO_tencent_translation_api.md | 2023-11-15 | 初始创建 | AI助手 |
| 部署指南.md | 2023-11-15 | 更新腾讯API配置说明 | AI助手 |