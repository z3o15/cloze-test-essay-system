# å®Œå½¢å¡«ç©ºç³»ç»Ÿ - æœ€ç»ˆä¿®æ”¹å¯ç”¨ç‰ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªæ™ºèƒ½å®Œå½¢å¡«ç©ºç³»ç»Ÿï¼Œæ”¯æŒè‹±è¯­æ–‡ç« çš„ç¿»è¯‘æ˜¾ç¤ºå’Œå•è¯éš¾åº¦åˆ†æã€‚ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæä¾›æ™ºèƒ½çš„å•è¯ç¿»è¯‘æ˜¾ç¤ºåŠŸèƒ½ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. æ™ºèƒ½ç¿»è¯‘æ˜¾ç¤º
- **è‡ªåŠ¨ç¿»è¯‘**: ç³»ç»Ÿè‡ªåŠ¨ç¿»è¯‘æ–‡ç« æ®µè½
- **å•è¯ç¿»è¯‘**: æ™ºèƒ½æ˜¾ç¤ºéš¾åº¦â‰¥2çš„å•è¯ç¿»è¯‘
- **ç¼“å­˜æœºåˆ¶**: é¿å…é‡å¤æŸ¥è¯¢ï¼Œæé«˜æ€§èƒ½

### 2. å•è¯éš¾åº¦åˆ†æ
- **AIåˆ†æ**: ä½¿ç”¨AIæ¨¡å‹åˆ†æå•è¯éš¾åº¦ï¼ˆ1-5çº§ï¼‰
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡åˆ†æå¤šä¸ªå•è¯
- **æ•°æ®å­˜å‚¨**: è‡ªåŠ¨å­˜å‚¨åˆ†æç»“æœåˆ°æ•°æ®åº“

## ğŸ”§ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Vue 3** + **TypeScript**
- **Vite** æ„å»ºå·¥å…·
- **å“åº”å¼è®¾è®¡**

### åç«¯æŠ€æœ¯æ ˆ
- **Node.js** + **TypeScript**
- **Express** æ¡†æ¶
- **MySQL** æ•°æ®åº“
- **Redis** ç¼“å­˜

## ğŸ“Š ç¿»è¯‘æ˜¾ç¤ºæµç¨‹

### å®Œæ•´å·¥ä½œæµç¨‹
```
é¡µé¢åŠ è½½ â†’ æå–å•è¯ â†’ AIéš¾åº¦åˆ†æ â†’ é¢„åŠ è½½ç¿»è¯‘ â†’ æ™ºèƒ½æ˜¾ç¤º
```

### è¯¦ç»†æµç¨‹è¯´æ˜

#### 1. å†…å®¹åŠ è½½é˜¶æ®µ
```javascript
// 1. åŠ è½½æ–‡ç« å†…å®¹
loadData() â†’ processContent()

// 2. æå–æ‰€æœ‰å•è¯
extractAllWordsFromContent(content) â†’ è·å–å”¯ä¸€å•è¯åˆ—è¡¨
```

#### 2. AIåˆ†æé˜¶æ®µ
```javascript
// 3. å•è¯éš¾åº¦åˆ†æ
processWordsWithAI(words) â†’ {
  // æŸ¥è¯¢æ•°æ®åº“å·²æœ‰å•è¯
  queryWordFromDatabase(word)
  
  // AIåˆ†ææ–°å•è¯éš¾åº¦
  WordDifficultyService.analyzeWords(newWords)
  
  // å­˜å‚¨åˆ†æç»“æœ
  å­˜å‚¨åˆ°æ•°æ®åº“
}
```

#### 3. ç¿»è¯‘é¢„åŠ è½½é˜¶æ®µ
```javascript
// 4. é¢„åŠ è½½ç¿»è¯‘
preloadTranslations(allWords) â†’ {
  // å¹¶å‘æŸ¥è¯¢æ‰€æœ‰å•è¯ç¿»è¯‘
  Promise.all(words.map(fetchWordTranslation))
}
```

#### 4. æ™ºèƒ½æ˜¾ç¤ºé˜¶æ®µ
```javascript
// 5. æ¨¡æ¿æ¸²æŸ“æ—¶æ˜¾ç¤ºç¿»è¯‘
getWordTranslationForDisplay(word) â†’ {
  // æ£€æŸ¥éš¾åº¦çº§åˆ« >= 2
  if (wordInfo.difficultyLevel >= 2) {
    return translation // æ˜¾ç¤ºç¿»è¯‘
  }
  return '' // ä¸æ˜¾ç¤ºç¿»è¯‘
}
```

## ğŸ¨ æ ¸å¿ƒç»„ä»¶

### Display.vue - ä¸»æ˜¾ç¤ºç»„ä»¶

#### å…³é”®å“åº”å¼æ•°æ®
```typescript
// ç¿»è¯‘å­˜å‚¨
const wordTranslations = ref<Record<string, string>>({})

// ç¿»è¯‘çŠ¶æ€
const translationStatus = ref<'idle' | 'translating' | 'completed' | 'failed'>('idle')

// æ®µè½ä¿¡æ¯
const paragraphInfos = ref<ParagraphInfo[]>([])
```

#### æ ¸å¿ƒå‡½æ•°

##### 1. fetchWordTranslation() - å¼‚æ­¥è·å–ç¿»è¯‘
```typescript
const fetchWordTranslation = async (word: string) => {
  // é¿å…é‡å¤æŸ¥è¯¢
  if (wordTranslations.value[key] !== undefined) return
  
  // æŸ¥è¯¢æ•°æ®åº“
  const wordInfo = await queryWordFromDatabase(word)
  
  // åªæœ‰éš¾åº¦ >= 2 çš„å•è¯æ‰æ˜¾ç¤ºç¿»è¯‘
  if (wordInfo && wordInfo.difficultyLevel >= 2) {
    wordTranslations.value[key] = wordInfo.definitions[0]
  }
}
```

##### 2. getWordTranslationForDisplay() - è·å–æ˜¾ç¤ºç¿»è¯‘
```typescript
const getWordTranslationForDisplay = (word: string): string => {
  const key = word.toLowerCase()
  
  // æ£€æŸ¥ç¼“å­˜
  if (wordTranslations.value[key] !== undefined) {
    return wordTranslations.value[key]
  }
  
  // å¼‚æ­¥æŸ¥è¯¢
  fetchWordTranslation(word)
  return ''
}
```

##### 3. preloadTranslations() - é¢„åŠ è½½ç¿»è¯‘
```typescript
const preloadTranslations = async (words: string[]) => {
  const promises = words.map(word => fetchWordTranslation(word))
  await Promise.all(promises)
}
```

## ğŸ“‹ æ•°æ®ç»“æ„

### WordInfo - å•è¯ä¿¡æ¯
```typescript
interface WordInfo {
  id?: number
  word: string
  difficultyLevel: number  // 1-5çº§éš¾åº¦
  definitions: string[]    // ç¿»è¯‘å®šä¹‰
  createdAt?: Date
  updatedAt?: Date
}
```

### ParagraphInfo - æ®µè½ä¿¡æ¯
```typescript
interface ParagraphInfo {
  translation?: string     // æ®µè½ç¿»è¯‘
  words?: string[]        // åŒ…å«çš„å•è¯
}
```

## ğŸ¯ æ˜¾ç¤ºè§„åˆ™

### ç¿»è¯‘æ˜¾ç¤ºæ¡ä»¶
- **éš¾åº¦çº§åˆ« â‰¥ 2** çš„å•è¯æ‰æ˜¾ç¤ºç¿»è¯‘
- **æ˜¾ç¤ºä½ç½®**: å•è¯æ­£ä¸‹æ–¹
- **æ˜¾ç¤ºå†…å®¹**: ä¸­æ–‡ç¿»è¯‘ï¼ˆdefinitions[0]ï¼‰

### ç¼“å­˜ç­–ç•¥
- **å­˜å‚¨é˜¶æ®µ**: æ‰€æœ‰æŸ¥è¯¢çš„å•è¯éƒ½å­˜å…¥æ•°æ®åº“
- **æ˜¾ç¤ºé˜¶æ®µ**: åªæœ‰ç¬¦åˆæ¡ä»¶çš„å•è¯æ˜¾ç¤ºç¿»è¯‘
- **æ€§èƒ½ä¼˜åŒ–**: ä½¿ç”¨ wordTranslations ç¼“å­˜é¿å…é‡å¤æŸ¥è¯¢

## ğŸ”§ æ€§èƒ½ä¼˜åŒ–

### 1. å¹¶å‘æ§åˆ¶
```typescript
const MAX_CONCURRENT_REQUESTS = 5
const activeRequests = new Set<string>()
```

### 2. å»é‡å¤„ç†
- æå–å”¯ä¸€å•è¯åˆ—è¡¨
- é¿å…é‡å¤APIè°ƒç”¨

### 3. æ‰¹é‡å¤„ç†
- ä¸€æ¬¡æ€§åˆ†æå¤šä¸ªå•è¯
- å¹¶å‘æŸ¥è¯¢ç¿»è¯‘

### 4. ç¼“å­˜æœºåˆ¶
- å“åº”å¼ç¿»è¯‘ç¼“å­˜
- æ•°æ®åº“æŸ¥è¯¢ç¼“å­˜

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ views/
â”‚   â””â”€â”€ Display.vue          # ä¸»æ˜¾ç¤ºç»„ä»¶
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ translationService.ts    # ç¿»è¯‘æœåŠ¡
â”‚   â””â”€â”€ wordDifficultyService.ts # å•è¯éš¾åº¦æœåŠ¡
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ wordService.ts       # å•è¯å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ databaseService.ts   # æ•°æ®åº“æœåŠ¡
â””â”€â”€ types/
    â””â”€â”€ wordDifficulty.ts    # ç±»å‹å®šä¹‰
```

## ğŸš€ éƒ¨ç½²è¯´æ˜

### å¼€å‘ç¯å¢ƒ
```bash
# å‰ç«¯
npm run dev

# åç«¯
cd backend && npm run dev
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# æ„å»ºå‰ç«¯
npm run build

# å¯åŠ¨åç«¯
cd backend && npm start
```

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- [x] æ–‡ç« å†…å®¹æ­£å¸¸æ˜¾ç¤º
- [x] æ®µè½ç¿»è¯‘åŠŸèƒ½æ­£å¸¸
- [x] å•è¯ç¿»è¯‘æ™ºèƒ½æ˜¾ç¤ºï¼ˆéš¾åº¦â‰¥2ï¼‰
- [x] AIå•è¯éš¾åº¦åˆ†ææ­£å¸¸
- [x] æ•°æ®åº“å­˜å‚¨åŠŸèƒ½æ­£å¸¸

### æ€§èƒ½éªŒæ”¶
- [x] é¡µé¢åŠ è½½é€Ÿåº¦ < 3ç§’
- [x] ç¿»è¯‘æŸ¥è¯¢å“åº” < 1ç§’
- [x] å¹¶å‘å¤„ç†èƒ½åŠ›æ­£å¸¸
- [x] ç¼“å­˜æœºåˆ¶æœ‰æ•ˆ

### ç”¨æˆ·ä½“éªŒéªŒæ”¶
- [x] ç•Œé¢ç¾è§‚æ˜“ç”¨
- [x] ç¿»è¯‘æ˜¾ç¤ºæ¸…æ™°
- [x] åŠ è½½çŠ¶æ€æç¤º
- [x] é”™è¯¯å¤„ç†å®Œå–„

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (æœ€ç»ˆä¿®æ”¹å¯ç”¨ç‰ˆ)
- âœ… é‡æ–°è®¾è®¡ç¿»è¯‘æ˜¾ç¤ºé€»è¾‘
- âœ… ç§»é™¤å¤æ‚ç¼“å­˜æœºåˆ¶
- âœ… ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- âœ… å®Œå–„é”™è¯¯å¤„ç†
- âœ… æ·»åŠ é¢„åŠ è½½æœºåˆ¶

## ğŸ”® åç»­ä¼˜åŒ–å»ºè®®

1. **åŠŸèƒ½å¢å¼º**
   - æ·»åŠ å•è¯æ”¶è—åŠŸèƒ½
   - æ”¯æŒè‡ªå®šä¹‰éš¾åº¦é˜ˆå€¼
   - å¢åŠ å­¦ä¹ è¿›åº¦è·Ÿè¸ª

2. **æ€§èƒ½ä¼˜åŒ–**
   - å®ç°è™šæ‹Ÿæ»šåŠ¨
   - ä¼˜åŒ–å¤§æ–‡ç« åŠ è½½
   - æ·»åŠ ç¦»çº¿ç¼“å­˜

3. **ç”¨æˆ·ä½“éªŒ**
   - æ·»åŠ å¿«æ·é”®æ”¯æŒ
   - ä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒ
   - å¢åŠ ä¸ªæ€§åŒ–è®¾ç½®